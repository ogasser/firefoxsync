/* This Source Code Form is subject to the terms of the Mozilla Public
*  License, v. 2.0. If a copy of the MPL was not distributed with this file,
*  You can obtain one at http://mozilla.org/MPL/2.0/.  */
!function(a){a(function(a,b,c,d){"use strict";function e(a){if(Object.create)return Object.create(a);var b=function(){};return b.prototype=a,new b}function f(){return(new Date).getTime()}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}var h,i={init:function(a){a=a||{},this.navigationTiming=e(l),this.navigationTiming.init(a),this.baseTime=this.navigationTiming.get().navigationStart||f(),this.timers=e(m),this.timers.init({baseTime:this.baseTime}),this.events=e(n),this.events.init({baseTime:this.baseTime}),this.uuid=g(),this.tags=a.tags||[];try{this.returning=!!localStorage.getItem("_st"),localStorage.setItem("_st","1")}catch(b){}},getLoad:function(){var a;try{a=sessionStorage.getItem("_puuid"),sessionStorage.removeItem("_puuid")}catch(b){}return{uuid:this.uuid,puuid:a,navigationTiming:this.navigationTiming.diff(),referrer:document.referrer||"",tags:this.tags,returning:this.returning,screen:{width:window.screen.width,height:window.screen.height}}},getUnload:function(){try{sessionStorage.setItem("_puuid",this.uuid)}catch(a){}return{uuid:this.uuid,duration:f()-this.baseTime,timers:this.timers.get(),events:this.events.get()}}},j={navigationStart:d,unloadEventStart:d,unloadEventEnd:d,redirectStart:d,redirectEnd:d,fetchStart:d,domainLookupStart:d,domainLookupEnd:d,connectStart:d,connectEnd:d,secureConnectionStart:d,requestStart:d,responseStart:d,responseEnd:d,domLoading:d,domInteractive:d,domContentLoadedEventStart:d,domContentLoadedEventEnd:d,domComplete:d,loadEventStart:d,loadEventEnd:d};try{h=window.performance.timing}catch(k){h=e(j)}var l={init:function(a){a=a||{},this.navigationTiming=a.navigationTiming||h,this.baseTime=this.navigationTiming.navigationStart||f()},get:function(){return this.navigationTiming},diff:function(){var a={},b=this.baseTime;for(var c in j)a[c]=this.navigationTiming[c]?this.navigationTiming[c]-b:null;return a}},m={init:function(a){this.completed={},this.running={},this.baseTime=a.baseTime},start:function(a){var b=f();if(this.running[a])throw new Error(a+" timer already started");this.running[a]=b},stop:function(a){var b=f();if(!this.running[a])throw new Error(a+" timer not started");this.completed[a]||(this.completed[a]=[]);var c=this.running[a];this.completed[a].push({start:c-this.baseTime,stop:b-this.baseTime,elapsed:b-c}),this.running[a]=null,delete this.running[a]},get:function(a){return a?this.completed[a]:this.completed},clear:function(){this.completed={},this.running={}}},n={init:function(a){this.events=[],this.baseTime=a.baseTime},capture:function(a){this.events.push({type:a,offset:f()-this.baseTime})},get:function(){return this.events},clear:function(){this.events=[]}};c.exports=e(i)})}(function(a,b){return"function"==typeof define&&define.amd?define:"object"==typeof module?function(a){a(require,exports,module)}:function(c){var d={exports:{}},e=function(a){return b[a]};b[a]=c(e,d.exports,d)||d.exports}}("SpeedTrap",this));